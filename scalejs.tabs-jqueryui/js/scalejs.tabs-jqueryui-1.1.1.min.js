define("text!scalejs.tabs-jqueryui/tabs.html",[],function(){return'<div id="tabs_template">\r\n    <div class="tabs" style="height:100%">\r\n        <div data-class="tabs-header-right" style="position:absolute;right:0px;"></div>\r\n            <ul class="tab-headers" data-class="tabs-sortable"></ul>\r\n                <!-- ko class: tabs-items-source -->\r\n                <div class="tabs-content-container">\r\n                        <!-- ko class:tabs-content-template -->\r\n                        <!-- /ko -->\r\n                </div>\r\n                <!-- /ko -->\r\n    </div>\r\n    <div class="tabs-more tabs-menu">\r\n    <!-- ko foreach: itemsSource -->\r\n        <div class="tabs-menu-item">\r\n            <span data-class="tabs-more-item"></span>\r\n            <div class="iconClose" data-class="tab-close"></div>\r\n        </div>\r\n    <!-- /ko -->       \r\n    </div> \r\n        <div class="tabs-add tabs-menu">\r\n            <!-- ko foreach: menuItems -->\r\n                <div class="tabs-menu-item" data-bind="text: header, click: addTab"></div>\r\n            <!-- /ko -->\r\n    </div>\r\n</div>\r\n\r\n <div id="tabs_content_default_template">\r\n         <p data-bind="text: $data"></p>\r\n</div>\r\n \r\n <div id="tabs_more_item_template">\r\n    <li class="tabs-menu-item">\r\n     <div class="tabs-header-text" data-class="tabs-header-text"></div>\r\n     <div class="iconClose" data-class="tab-close"></div></li>\r\n</div>\r\n\r\n <div id="tabs_header_item_template">\r\n    <li>\r\n        <a data-class="tabs-header">\r\n            <div class="tabs-header-text" data-class="tabs-header-text"></div>\r\n        </a>\r\n        <div class="iconClose" data-class="tab-more-close"></div>\r\n        <div class="iconMore" data-class="tab-more"></div>\r\n        <!--<div class="iconMax" data-class="tab-max"></div>-->\r\n    </li>\r\n</div>\r\n\r\n <div id="tabs_menu_temp_template">\r\n    <div class="tabs-menu">\r\n        <!-- ko foreach: menuItems -->\r\n            <div class="tabs-menu-item" data-bind="text: header, click: addTab"></div>\r\n        <!-- /ko -->\r\n    </div> \r\n</div>'}),define("scalejs.tabs-jqueryui/tabsBindings",{"tabs-header":function(){return{click:function(t,e){e.preventDefault()}}},"tabs-header-text":function(){return{text:this.header}},"tabs-items-source":function(){return{foreach:this.itemsSource}},"tabs-header-edit":function(){return{value:this.header,valueUpdate:"afterkeydown"}},"tabs-content-template":function(t){var e=this.contentTemplate||t.$parent.contentTemplate||"tabs_content_default_template";return{template:{name:e,data:this.content}}},"tabs-header-right":function(){return this.headerTemplate?{template:{name:this.headerTemplate,data:this.content}}:{}},"tab-more-close":function(t){var e=t.$parent.itemsSource,a=(t.$parent.refreshTabs,t.$parent.active);return{click:function(){t.$data.onRemove&&t.$data.onRemove(),a()===t.$index()?a(0):a()>t.$index()&&a(a()-1),e.remove(t.$data)},visible:!t.$parent.more()}},"tab-close":function(t){{var e=t.$parent.itemsSource;t.$parent.refreshTabs,t.$parent.active}return{click:function(){t.$data.onRemove&&t.$data.onRemove(),e.remove(t.$data)}}},"tab-max":function(){return{click:function(t){console.log("maximixing",t)}}},"tabs-sortable":function(){return{sortable:{template:"tabs_header_item_template",data:this.itemsSource,options:this.sortOptions,afterMove:this.afterMove}}},"tab-more":function(t){return{visible:t.$parent.more,click:t.$parent.openMore}},"tabs-more-item":function(t){return{style:{color:t.$parent.active()===t.$index()?"red":"white"},text:this.header}}}),define("scalejs.tabs-jqueryui",["scalejs!core","knockout","jQuery","text!./scalejs.tabs-jqueryui/tabs.html","./scalejs.tabs-jqueryui/tabsBindings","scalejs.mvvm","bPopup","knockout-sortable"],function(t,e,a,n,i){function s(n,i){return function(){function s(){h=a(e.virtualElements.firstChild(i)).parent(),y.add=a(a(h).find(".tabs-add")).hide(),y.more=a(a(h).find(".tabs-more")).hide(),p=a(a(h).find(".tabs")).tabs(options),a.widget("ui.tabs",a.ui.tabs,{options:{keyboard:!0},_tabKeydown:function(){return this.options.keyboard?(this._super("_tabKeydown"),void 0):!1}}),p.delegate("a.ui-tabs-anchor","dblclick",function(){var t,n=e.dataFor(this).header,i=this;c(n)&&(a(i).find("[data-class='tabs-header-text']").replaceWith("<input data-class='tabs-header-edit' />"),t=a(i).find("input"),e.applyBindings(e.dataFor(this),t.get(0)),t.focus(),t.bind("keyup",function(n){var s=n.keyCode||n.which;13==s&&(t.replaceWith("<div class='tabs-header-text' data-class='tabs-header-text'></div>"),e.applyBindings(e.dataFor(i),a(i).find("[data-class='tabs-header-text']").get(0)))}),t.bind("blur",function(){t.replaceWith("<div class='tabs-header-text' data-class='tabs-header-text'></div>"),e.applyBindings(e.dataFor(i),a(i).find("[data-class='tabs-header-text']").get(0))}))}),t.layout&&t.layout.onLayoutDone&&t.layout.onLayoutDone(function(){p.find(".ui-tabs-panel").each(function(){var t=p.height(),e=p.find(".tab-headers").height();a(this).height(t-e)})}),a(window).resize(o),g.itemsSource.subscribe(function(){r()})}function r(){p.find('a[data-class="tabs-header"]').each(function(t,e){a(e).attr("href","#tabs-"+t)}),p.find(".tabs-content-container").each(function(t,e){a(e).attr("id","tabs-"+t)}),p.tabs("destroy"),p=a(a(h).find(".tabs")).tabs(options),p.tabs("option","active",g.active()),g.active.valueHasMutated(),y.more.find(".tabs-menu-item").each(function(t,e){a(e).unbind().click(function(){y.more.bPopup({opacity:0}).close(),g.active(t),r()})}),d(),o()}function o(){var t=p.outerWidth(),e=p.find("ul.tab-headers"),n=e.find("li").show(),i=n.get().reduce(function(t,e){return t+=a(e).outerWidth()},0)+20;g.more(!1),i>t&&(n.hide(),g.more(!0),e.find(".ui-state-active").show()),d()}function d(){var t;p.find("li.add").remove(),$headers=p.find("ul.tab-headers"),$headers.append('<li class="unsortable add"><a href="#tabs-add">+</a></li>'),t=p.find('[href="#tabs-add"]'),t.unbind().click(function(e){e.preventDefault(),y.add.bPopup({follow:[!1,!1],position:[t.offset().left+p.find("li.add").width(),t.offset().top],opacity:0,speed:0})})}var m,f,h,p,g=n(),y={};return options={activate:function(){g.active(p.tabs("option","active"))}},g.sortOptions={items:"li:not(.unsortable)",axis:"x",start:function(){f=g.itemsSource(),m=g.itemsSource()[g.active()],p.find("li.unsortable").remove()},stop:function(){f.length!==g.itemsSource.length&&g.itemsSource(f)}},g.menuItems=l(u(b(g.defaultItems)).select(function(t){var e=v(t,{addTab:function(){y.add.bPopup({opacity:0}).close(),g.active(g.itemsSource().length),g.itemsSource.push(t.create())}});return e}).toArray()),g.afterMove=function(){g.active(g.itemsSource.indexOf(m)),p.tabs("option","active",g.active())},g.refreshTabs=r,g.more=e.observable(!1),g.active=g.active||e.observable(1),g.active.subscribe(function(){setTimeout(function(){console.log("invalidate"),t.layout.invalidate({reparse:!1})},0)}),g.openMore=function(){var t=a(p.find("li").get(g.active()));y.more.bPopup({follow:[!1,!1],position:[t.offset().left+10,t.offset().top+t.outerHeight()+10],opacity:0,speed:0})},{data:g,name:"tabs_template",afterRender:function(){if(g.itemsSource.length>0)s(),r();else var t=g.itemsSource.subscribe(function(){s(),r(),t.dispose()})}}}}function r(t,a,n,i,r){return e.bindingHandlers.template.update(t,s(a,t),n,i,r),{controlsDescendantBindings:!0}}var o=t.mvvm.registerTemplates,d=t.mvvm.registerBindings,c=e.isObservable,l=e.observableArray,u=t.linq.enumerable.from,b=e.unwrap,v=t.object.merge;o(n),d(i),e.bindingHandlers.tabs={init:r},e.virtualElements.allowedBindings.tabs=!0,e.virtualElements.allowedBindings.sortable=!0});